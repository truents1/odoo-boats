<odoo>
  <template id="owner_boats" name="Owner Boats" inherit_id="website.layout">
    <xpath expr="//main" position="inside">
      <section class="container mt-4">
        <h2>Your Boats</h2>
        <a class="btn btn-primary my-2" href="/owner/boats/new">New Boat</a>
        <t t-if="not boats">
          <p>No boats yet.</p>
        </t>
        <div class="row">
          <t t-foreach="boats" t-as="b">
            <div class="col-md-4 mb-3">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title"><t t-esc="b.name"/></h5>
                  <p>State: <t t-esc="b.state"/></p>
                  <p>Region: <t t-esc="b.region_id.name"/></p>
                </div>
              </div>
            </div>
          </t>
        </div>
      </section>
    </xpath>
  </template>

  <template id="owner_boat_form" name="Owner Boat Form" inherit_id="website.layout">
    <xpath expr="//main" position="inside">
      <section class="container mt-4">
        <h2>Submit Boat</h2>
        <form id="boatForm">
          <div class="mb-3">
            <label>Name</label>
            <input class="form-control" name="name" required="1"/>
          </div>
          <div class="mb-3">
            <label>Region</label>
            <select class="form-select" name="region_id">
              <t t-foreach="request.env['boat.region'].sudo().search([])" t-as="r">
                <option t-att-value="r.id"><t t-esc="r.name"/></option>
              </t>
            </select>
          </div>
          <div class="mb-3">
            <label>Category</label>
            <select class="form-select" name="category_id">
              <t t-foreach="request.env['boat.category'].sudo().search([])" t-as="c">
                <option t-att-value="c.id"><t t-esc="c.name"/></option>
              </t>
            </select>
          </div>
          <div class="mb-3">
            <label>Guest Capacity</label>
            <input class="form-control" name="guest_capacity" type="number" value="2"/>
          </div>
          <div class="mb-3">
            <label>Pricing Period</label>
            <select class="form-select" name="pricing_period">
              <option value="day_boat">Daily per boat</option>
              <option value="day_pp">Daily per person</option>
              <option value="hour_pp">Hourly per person</option>
            </select>
          </div>
          <div class="mb-3">
            <label>Base Rent</label>
            <input class="form-control" name="price_rent" type="number" value="0"/>
          </div>
          <button type="submit" class="btn btn-success">Submit</button>
        </form>
        <script>
          document.getElementById('boatForm').addEventListener('submit', async (e) => {{
            e.preventDefault();
            const form = e.target;
            const data = Object.fromEntries(new FormData(form).entries());
            const res = await fetch('/owner/boats/create', {{
              method: 'POST',
              headers: {{'Content-Type': 'application/json'}},
              body: JSON.stringify(data)
            }});
            const js = await res.json();
            if (js.ok) window.location = '/owner/boats';
            else alert('Error');
          }});
        </script>
      </section>
    </xpath>
  </template>
</odoo>
